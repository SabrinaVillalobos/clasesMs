let soapCLientModule = require("../module/soapClientModule");
let soapClient = new soapCLientModule();

var url = 'http://167.28.65.55:6106/services/ProcessEmailNB/v1.0?WSDL';
let request = {
    header: {
        "ServiceId": "ProcessEmailNB",
        "Type": "Request",
        "InstitutionType": "BECH",
        "ChannelId": "HB",
        "FeatureId": "TEST",
        "BranchId": "",
        "TerminalId": "",
        "TimeStamp": "",
        "Client": {
            "UserAgent": "new Buffer(req.headers['user-agent']).toString('base64')",
            "Address": "req.connection.remoteAddress",
            "SessionId": "0", //datosToken.idSesion,
            "UserId": "",
            "OerationId": "0"
        }
    },
    body: {
        email: {
            fromAddress: "noreply@gmail.com",
            toAddresses: "fnunez7@bancoestado.cl",
            ccAddresses: "",
            bccAddresses: "",
            messageSubject: "TEST",
            messageBody: "<![CDATA[<html><head> <meta http-equiv='Content-Type' content='text/html; charset=utf-8' /> <style type='text/css'> div.color { border-width: 2px; border-style: solid; border-color: #ff9900; margin-top: 15px; margin-bottom: 10px; } </style></head><body> <table border='0'> <tr> <td style='text-align:right !important;' width='500px'> <img src='http://www.bancoestado.cl/imagenes/technisys/header.gif' /> </td> </tr> <tr> <td> <div style='border-style: solid; border-color: #F1801A; border-width: 1px; margin-top: 15px;padding:10px;'> <table width='500' align='center'> <tr> <td align='right'> <font face='Lao Sangam MN' size=2 color='#A39898'>${fecha_actual}</font> </td> </tr> <tr> <td colspan='3' align='center'> <b><font face='Lao Sangam MN' size=4 color='#F38D53'>Comprobante de Transferencia Electronica de Fondos (TEF)</font></b> <hr width=100% align='center'> </td> </tr> <tr> <td colspan='3'> <font face='Lao Sangam MN' size=2 color='#A39898'>Estimado(a)</font><font face='Lao Sangam MN' size=2 color='#000000'><b> ${nombre_cliente}:</b></font> </td> </tr> <tr> <td colspan='3'> <font face='Lao Sangam MN' size=2 color='#A39898'>Acabas de realizar una Transferencia Electronica, con los siguientes datos:</font> </td> </tr> <tr> <td> <table height='200' width='500' align='center'> <tr> <td colspan='2' bgcolor='#F9A21D'> <font face='Lao Sangam MN' size=3 color='#FFFFFF'> <center>Monto Transferido<strong> $${monto}</strong></center> </font> </td> </tr> <tr> <td height='25' colspan='2'><span style='font-family:Arial,Helvetica,sans-serif; color:#F1801A; font-size:15px'><strong>Desde:</strong></span></td> </tr> <tr> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'><b>&nbsp;&nbsp;Producto</b></td> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'> : ${desde_producto} </td> </tr> <tr> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #F2F2F2;'><b>&nbsp;&nbsp;N&deg; de cuenta</b></td> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #F2F2F2;'>: ${desde_nro_cuenta} </td> </tr> <tr> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'><b>&nbsp;&nbsp;N&deg; de Tef</b></td> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'>: ${desde_nro_tef} </td> </tr> <tr> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #F2F2F2;'><b>&nbsp;&nbsp;Fecha y Hora de TEF</b></td> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #F2F2F2;'>: ${desde_fecha_hora} </td> </tr> <tr> <td height='25' colspan='2'><span style='font-family:Arial,Helvetica,sans-serif; color:#F1801A; font-size:15px'><strong>Hacia:</strong></span></td> </tr> <tr> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'><b>&nbsp;&nbsp;Producto</b></td> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'>: ${hacia_producto}</td> </tr> <tr> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #F2F2F2;'><b>&nbsp;&nbsp;N&deg; de cuenta</b></td> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #F2F2F2;'>: ${hacia_nro_cuenta} </td> </tr> <tr> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'><b>&nbsp;&nbsp;Comentario </b> </td> <td style='font-family:Arial, Helvetica,sans-serif; color:#000000; font-size:12px; height: 25; width: 50%; background-color: #FBF8EF;'>: ${hacia_comentario} </td> </tr> <tr> <td colspan='2'> <img align='right' src='http://www.bancoestado.cl/imagenes/comun2008/ctef_timbre.jpg' /> </td> </tr> </table> </td> </tr> <!-- end table --> </table> </div> </td> </tr> <tr> <td style='text-align:right !important;' width='500px'> <img src='http://www.bancoestado.cl/imagenes/comun2008/disclaimer_tef_2012.jpg' /> </td> </tr> </table> <br></body></html>]]>",
            signature: ""
        }
    }
}
let options = {timeout:3000}

//Definición de nombre de función a llamar
var funcionWSDL = ['ProcessEmailNB', 'ProcessEmailNB', 'ProcessEmailNB'];

soapClient.busSoapCall(url, options, request, funcionWSDL)
.then(result =>{
    console.log(result);
}).catch(err => {
    console.log(err);
})